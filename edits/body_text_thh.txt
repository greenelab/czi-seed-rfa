Proposal Body (2000 words)
The Human Cell Atlas (HCA) provides unprecedented characterization of molecular phenotypes across individuals, tissues and disease states -- resolving differences to the level of individual cells. The enormous opportunities for scientific advancement that HCA provides will depend on our ability to search a transcendentally high dimensional space where each of thousands cells in a single sample generates unique gene expression profiles of tens of thousands of genes. Although challenging, it is possible to create low dimension representations of HCA data that preserve the important features of the original high dimensional data, but allow accurate and rapid searching and classification. Our seed network will bring together biologists and computer scientists from five leading academic institutions who will work together to create foundational technologies educational opportunities that promote effective use of Human Cell Atlas data. 
 
Scientific Goals
We will create low-dimensional representations that provide search and catalog capabilities for the HCA. We believe these approaches are crucial to the long term success of the HCA [I think their current plan is a free text search of the archive based on either cell type or tissue, or conditions. In my opinion, that is much better than nothing. Other repositories like GEO sort of work, and that's their approach. We need t articulate why that is inadequate or at least sub-optimal -THH]  Our central hypothesis is that these approaches will enable faster algorithms while reducing the influence of technical noise. We propose to advance base enabling technologies for low-dimensional representations. 

First, we will identify techniques that learn interpretable, biologically-aligned representations. We  will consider both linear and non-linear techniques [because X]. For linear techniques, we rely on our Bayesian, non-negative matrix factorization method scCoGAPS [@doi:10.1101/378950,@doi:10.1101/395004](PIs Fertig & Goff). This technique learns biologically relevant features across contexts and data modalities [@doi:10.1186/1471-2164-13-160,@doi:10.18632/oncotarget.12075,@doi:10.1007/978-1-62703-721-1_6,@doi:10.1186/s13073-018-0545-2,@doi:10.1101/378950], including notably the HPN DREAM8 challenge [@doi:10.1038/nmeth.3773]. This technique is specifically selected as a base enabling technology because its error distribution can naturally account for measurement-specific technical variation [@doi:10.1371/journal.pone.0078127] and its prior distributions for different feature quantifications or spatial information. For non-linear needs, neural networks with multiple layers, provide a complementary path to low-dimensional representations [@doi:10.1101/385534] (PI Greene) that model these diverse features of HCA data. We will make use of substantial progress that has already been made in both linear and non-linear techniques (e.g., [@doi:10.1101/300681,@doi:10.1101/292037,@doi:10.1101/237065,@doi:10.1101/315556,@doi:10.1101/457879,@doi:10.1016/j.cell.2017.10.023,@doi:10.7717/peerj.2888,@doi:10.1101/459891]) and rigorously evaluate emerging methods into our search and catalog tools. We will extend transfer learning methods, including ProjectR [@doi:10.1101/395004] (PIs Goff & Fertig) to enable rapid integration, interpretation, and annotation of learned latent spaces. The latent space team from the HCA collaborative networks RFA (including PIs Fertig, Goff, Greene, and Patro) is establishing common definitions and requirements for latent spaces for the HCA, as well as standardized output formats for low-dimensional representations from distinct classes of methods.

Second, we will improve techniques for fast and accurate quantification. Existing approaches for quantification for scRNA-seq data using tagged-end end protocols (e.g. 10x Chromium, drop-Seq, inDrop, etc.) have do not account for reads mapping between multiple genes. This reduces the accuracy of approximately 15-25% of the reads generated in a typical experiment, leading to systematic biases in the assignment of gene families and gene function[@doi:10.1101/335000]. To address this problem, we will build on a recently developed a quantification method for tagged-end data that accounts for reads mapping to multiple genomic loci in a principled and consistent way [CITE?]and extend it to scRNA-seq data. Our quantification tool will support: 1. Exploring alternative models for Unique Molecular Identifier (UMI) resolution. 2. Developing new approaches for quality control and filtering using the UMI-resolution graph. 3. Creating a compressed and indexible data structure for the UMI-resolution graph to enable direct access, query, and fast search prior to secondary analysis.

We will implement these base enabling technologies and methods for search, analysis, and latent space transformations as freely available R/Bioconductor libraries. We will additionally develop platform-agnostic input and output formats for latent space representations of the HCA data to maximize interoperability. These R libraries will be fast, scalable, and memory-efficient leveraging the computational tools previously developed by Bioconductor for single-cell data access to the HCA, data representation (SingleCellExperiment, beachmat, LinearEmbeddingMatrix, DelayedArray, HDF5Array and rhdf5) and data assessment and amelioration of data quality (scater, scran, DropletUtils).


Third, in addition to creating base enabling technologies and tools, we will provide other resources to the HCA community. These include 1) a versioned and annotated catalog of latent spaces, and corresponding to signatures of cell types, states, and biological attributes across the the HCA, and 2) short courses and educational materials that will increase the use and impact of low-dimensional representations and the HCA in general.

Aim 1
Rationale: The HCA provides a reference atlas to human cell types, states, and the biological processes in which they engage. The utility of the reference therefore requires that one can easily compare references to each other or a new sample to the compendium of reference samples. The very high dimensionality inherent in single cell RNA-seq data makes problematic. Low-dimensional representations, because they compress the space, provide the building blocks for search approaches that can be practically applied across very large datasets such as the HCA. We propose to develop algorithms and software for efficient search over the HCA using low-dimensional representations.

The primary approach to search in low-dimensional spaces is straightforward: one must create an appropriate low-dimensional representation and identify distance functions that reveal biologically meaningful differences. Ideal low dimension representations are predicted to be much faster to search but also more biologically relevant, because noise is one one of the features that low dimension representations remove. In this aim, we will evaluate candidate representations to identify those with optimal qualities of compression, noise reduction and retention of biologically meaningful features. Current approaches require investigators to perform gene-level quantification on the entirety of a new sample. We aim to enable search during sample preprocessing, prior to gene-level quantification. This will enable in-line annotation of cell types and states and identification of novel features as samples are being processed. We will implement and evaluate techniques to learn and transfer shared low-dimensional representations between the UMI-resolution graph and quantified samples, so that samples where either component is available can be used for search and annotation [CASEY ADD SHARED LATENT SPACE REF]. These UMI-graphs will be embedded in the prior of scCoGAPS and architecture of non-linear latent space techniques. [Do we need this line? It's a bit more specific than the rest of the paragraph -LAG]

Similarly to the approach by which comparisons to a reference genomes can identify specific differences in a genome of interest, we will use low-dimensional representations from latent spaces to define a reference transcriptome map (the HCA) and use this to quantify differences in target transcriptome maps from new samples of interest. We will leverage common low-dimensional representations and cell-to-cell correlation structure both within and across transcriptome maps from Aim 2 to define this reference. Quantifying the differences between samples characterized at the single-cell level reveals population or individual level differences. [<-- I'm not sure what this sentence means. Please clarify. - LAG] Comparison of scRNA-seq maps from individuals with a particular phenotype to the HCA reference that is computationally infeasible from the large scale of HCA data becomes tractable in these low dimensional spaces. We (PI Hicks) have extensive experience dealing with the distributions of cell expression within and between individuals [@pmid:26040460], which will be critical for defining an appropriate metric to compare references in latent spaces. We plan to implement and evaluate linear mixed models to account for the correlation structure within and between transcriptome maps. This statistical method will be fast, memory-efficient and will be scalable to billions of cells using low-dimensional representations.

Aim 2
Rationale: Biological systems are comprised of diverse cell types and states with overlapping molecular phenotypes. Furthermore, biological processes are often reused with modifications across cell types. Low-dimensional representations can identify these shared features, independent of total distance between cells in gene expression space, across large collections of data including the HCA. We will evaluate and select methods that define latent spaces that reflect discrete biological processes or cellular features. These latent spaces can be shared across different biological systems and can reveal context-specific divergence such as pathogenic differences in disease. We propose to establish a central catalog of cell types, states, and biological processes derived from low-dimensional representations of the HCA.

By establishing a catalog of cellular features using low-dimensional representations can reduce noise and aid in biological interpretability. However, there are currently no standardized, quantitative metrics to determine the extent to which low-dimensional representations capture generalizable biolobical features. We have developed new transfer learning methods to quantify the extent to which latent space representations from one set of training data are represented in another [@doi:10.1101/395004,@doi:10.1101/395947] (PIs Goff & Fertig). These provide a strong foundation to compare low-dimensional representations across different low-dimensional data representation technniques. Generalizable representations should transfer across datasets of related biological contexts, while representations of noise will not. In addition, we have found that combining multiple representations can better capture biological processes across scales [@doi:10.1016/j.cels.2017.06.003], and that representations across scales capture distinct, valid biological signatures [@doi:10.1371/journal.pone.0078127]. Therefore, we will establish a versioned catalog consisting of low-dimensional features learned across both linear and non-linear methods from our base enabling technologies and proposed extensions in Aim 1.

We will package and version low-dimensional representations and annotate these representations based on their corresponding celluar features (e.g. cell type, tissue, biological process) and deliver these as structured data objects in Bioconductor as well as platform-agnostic data formats. Such summaries and annotations have proven widely successful for the ENCODE, Roadmap Epigenome Mapping, and GTEx projects. We are core package developers and power users of Bioconductor (PIs Hicks and Love) and will support on-the-fly downloading of these materials via the AnnotationHub framework. To enable reproducible research leveraging HCA, we will implement a content-based versioning system, which identifies versions of the reference cell type catalog by the gene weights and transcript nucleotide sequences using a hash function. We (PI Love) developed hash-based versioning and provenance identification and detection framework for bulk RNA-seq that supports reproducible computational analyses and has proven to be successful [@doi:10.18129/B9.bioc.tximeta]. This will help to avoid scenarios where researchers report on matches to a certain cell type in HCA without precisely defining which definition of that cell type. We will develop F1000Research workflows demonstrating how HCA-defined reference cell types and tools developed in this RFA can be used within a typical genomic data analysis. This catalogue will be used as the basis of defining the references for cell type and state, or individual-specific differences with the linear models proposed in Aim 1.

Aim 3
Rationale: Low-dimensional representations for scRNA-seq and HCA data make tasks faster and provide interpretable summaries of complex high-dimensional data. The HCA data associated methods will be valuable to many biomedical fields, but their use will require an understanding of basic bioinformatics, scRNAseq, and how the search algorithms we develop work. This aim addresses these needs in three ways. 

First, we will develop and market a bioinformatic training program for biologist at all levels, including those with no experience in bioinformatics. Lecture materials will make use of materials from previous bioinformatic courses we (PI Hampton) we have run at Mount Desert Island Biological Laboratory, the University of Birmingham, UK and Geisel School of Medicine at Dartmouth since 2009. These courses have trained over 400 scientists in basic bioinformatics and always achieve approval ratings of over 90%.  We believe part of the success of these learning experiences has to do with our instructional paradigm, which includes a very challenging course project coupled with one-on-one support from instructors.  The course offering that will be created in response to this RFA is the most ambitious in our history, because single cell RNA-seq is more challenging than ordinary gene expression analysis. To achieve our training goals, we will develop a new curriculum specifically tailored to HCA, using single cell profiling based on previously developed didactic course material on single cell RNA-Seq analysis for the annual McKusick Short Course on Human and Mammalian Genetics (PI Goff) at Jackson Labs.) machine learning methods,  low-dimensional representations, and tools developed by our group in response to this RFA (PI Greene). 

Second, the short course will train not only students, but instructors. Our one-on-one approach to course projects will require a high instructor to student ratio. We will therefore recruit former participants of this class to return in subsequent years, first as teaching assistants, and later as module presenters. We have found that course alumni are eager to improve their teaching resumes, that they learn the material in a new way as they begin to teach it, and that they are an invaluable resource in understanding how to improve the course over time. Part of our strategy is to support this community, which includes many people who will drive the next wave of innovation. All of our course materials, such as slides, code and video lectures will be freely available, enabling course participants to bring what they learned home with them. A capstone session will be included in which we will provide suggestions about how the materials presented in the course can be incorporated into existing course curricula. Course faculty will be available to assist with integration effort after the course.

Finally, the short course will facilitate scientific collaborations as follows. In addition to engaging in group presentations as part of the class project that will involve scRNA-seq data retrieved from HCA, participants will also provide a 10-minute chalk talk explaining their research interests. This allows course faculty to identify course participants whose needs they can help address, both during and after the course.  The course design will include faculty office hours where participants can get help with any bioinformatic problems they are encountering with their ongoing research. 

We will provide this course free to 25 students twice a year, with the understanding that its effective reach will be much greater than the 150 students who enroll. Our students will begin to teach others, and our materials will be incorporated into many local courses.
